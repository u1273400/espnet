# lm_train.py --config conf/lm.yaml --ngpu 0 --backend pytorch --verbose 1 --outdir exp/train_rnnlm_pytorch_lm_word100 --tensorboard-dir tensorboard/train_rnnlm_pytorch_lm_word100 --train-label data/local/wordlm_train/train.txt --valid-label data/local/wordlm_train/valid.txt --test-label data/local/wordlm_train/test.txt --resume --dict data/local/wordlm_train/wordlist_100.txt 
# Started at Tue Nov 10 06:50:13 GMT 2020
#
2020-11-10 06:50:20,734 (lm_train:250) INFO: ngpu: 0
2020-11-10 06:50:20,735 (lm_train:253) INFO: python path = (None)
2020-11-10 06:50:20,735 (lm_train:270) INFO: backend = pytorch
2020-11-10 06:50:20,929 (lm:222) INFO: torch version = 1.7.0
2020-11-10 06:50:20,931 (deterministic_utils:26) INFO: torch type check is disabled
/mnt/c/Users/User/Dropbox/rtmp/src/python/notebooks/espnet/tools/venv/lib/python3.6/site-packages/torch/cuda/__init__.py:52: UserWarning: CUDA initialization: Found no NVIDIA driver on your system. Please check that you have an NVIDIA GPU and installed a driver from http://www.nvidia.com/Download/index.aspx (Triggered internally at  /opt/conda/conda-bld/pytorch_1603728993639/work/c10/cuda/CUDAFunctions.cpp:100.)
  return torch._C._cuda_getDeviceCount() > 0
2020-11-10 06:50:20,935 (lm:228) WARNING: cuda is not available
2020-11-10 06:50:20,935 (lm_utils:44) INFO: skip dump/load HDF5 because the output dir is not specified
2020-11-10 06:50:20,935 (lm_utils:45) INFO: reading text dataset: data/local/wordlm_train/valid.txt
0it [00:00, ?it/s]100it [00:00, 114661.13it/s]
2020-11-10 06:50:20,949 (lm_utils:44) INFO: skip dump/load HDF5 because the output dir is not specified
2020-11-10 06:50:20,949 (lm_utils:45) INFO: reading text dataset: data/local/wordlm_train/train.txt
0it [00:00, ?it/s]848it [00:00, 94089.46it/s]
2020-11-10 06:50:20,964 (lm:240) INFO: #vocab = 100
2020-11-10 06:50:20,964 (lm:241) INFO: #sentences in the training data = 848
2020-11-10 06:50:20,964 (lm:242) INFO: #tokens in the training data = 4851
2020-11-10 06:50:20,964 (lm:245) INFO: oov rate in the training data = 0.00 %
2020-11-10 06:50:20,964 (lm:247) INFO: #sentences in the validation data = 100
2020-11-10 06:50:20,964 (lm:248) INFO: #tokens in the validation data = 591
2020-11-10 06:50:20,964 (lm:250) INFO: oov rate in the validation data = 0.34 %
2020-11-10 06:50:20,965 (lm:273) INFO: #iterations per epoch = 3
2020-11-10 06:50:20,965 (lm:274) INFO: #total iterations = 60
2020-11-10 06:50:21,146 (lm:290) INFO: writing a model config file to exp/train_rnnlm_pytorch_lm_word100/model.json
2020-11-10 06:50:30,569 (lm_utils:255) INFO: best model is rnnlm.model.1
2020-11-10 06:50:40,213 (lm_utils:255) INFO: best model is rnnlm.model.2
2020-11-10 06:50:50,699 (lm_utils:255) INFO: best model is rnnlm.model.3
2020-11-10 06:51:00,272 (lm_utils:255) INFO: best model is rnnlm.model.4
2020-11-10 06:51:10,808 (lm_utils:255) INFO: best model is rnnlm.model.5
2020-11-10 06:51:20,143 (lm_utils:255) INFO: best model is rnnlm.model.6
2020-11-10 06:51:30,750 (lm_utils:255) INFO: best model is rnnlm.model.7
2020-11-10 06:51:41,066 (lm_utils:255) INFO: best model is rnnlm.model.8
2020-11-10 06:51:51,976 (lm_utils:255) INFO: best model is rnnlm.model.9
2020-11-10 06:52:05,070 (lm_utils:255) INFO: best model is rnnlm.model.10
2020-11-10 06:52:15,471 (lm_utils:255) INFO: best model is rnnlm.model.11
2020-11-10 06:52:47,801 (lm_utils:255) INFO: best model is rnnlm.model.14
2020-11-10 06:53:06,971 (lm_utils:255) INFO: best model is rnnlm.model.16
2020-11-10 06:53:16,586 (lm_utils:255) INFO: best model is rnnlm.model.17
[J2020-11-10 06:53:44,243 (lm:385) INFO: test the best model
0it [00:00, ?it/s]130it [00:00, 75332.90it/s]
2020-11-10 06:53:44,280 (lm:389) INFO: #sentences in the test data = 130
2020-11-10 06:53:44,280 (lm:390) INFO: #tokens in the test data = 773
2020-11-10 06:53:44,280 (lm:392) INFO: oov rate in the test data = 0.26 %
2020-11-10 06:53:45,246 (lm:400) INFO: test perplexity: 14.057691533779456
# Accounting: time=212 threads=1
# Ended (code 0) at Tue Nov 10 06:53:45 GMT 2020, elapsed time 212 seconds
